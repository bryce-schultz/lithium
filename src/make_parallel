#!/usr/bin/env bash

# This script was renamed from 'make' to 'make_parallel' to avoid conflicts
# with the system make command when called from CI or within this directory.
# It provides parallel compilation using all available CPU cores.
# 
# To use this script for faster local builds:
#   ./make_parallel
#   ./make_parallel clean

# strip out the current directory from PATH
if [[ -z "$PATH" ]]; then
  echo "PATH is not set. Exiting."
  exit 1
fi
PATH=$(echo "$PATH" | tr ':' '\n' | grep -v -x '\.' | paste -sd:)

# basic make wrapper to use all cores, just use like make.
make -j$(nproc) $@ || exit 1